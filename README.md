# Nico2PDF

Office文書（Word、Excel、PowerPoint）をPDFに変換し、結合するWPFアプリケーションです。

## 機能

- Office文書のPDF変換
- PDF結合
- プロジェクト管理
- ページ番号追加
- **しおり機能（チェックボックスで設定可能）**
- **ヘッダ・フッタ機能（カスタマイズ可能）**
- ファイル順序変更
- ファイル名変更（個別・一括）
- ドラッグ&ドロップによるフォルダ選択
- ファイル更新時の自動選択機能
- **NEW**: シンプルなクリップボード機能

## リリースノート

### v1.6.0 (2024年xx月xx日)
#### ? バージョンアップ
- バージョンを1.6.0に更新

### v1.5.0 (2024年12月17日)
#### ? 新機能
- **しおり機能の強化**: PDF結合時にチェックボックスでしおり追加を設定可能
  - 基本しおり機能：ファイル名をしおりとして追加
  - 高度なしおり機能：サブフォルダを含む場合、フォルダ別に階層構造でしおりを作成
  - しおりタイトルには表示名（リネーム後の名前）を使用
  - フォルダ別グループ化オプション追加
- **ヘッダ・フッタ機能の追加**: PDF結合時にヘッダとフッタを追加可能
  - ヘッダは左上に配置
  - フッタは右下に配置
  - ヘッダとフッタには同じテキストを表示
  - フォントサイズを調整可能（デフォルト：10pt）
  - カスタムテキストを自由に設定可能

#### ?? 改善点
- **PDF結合設定の充実**: より柔軟なPDF結合オプションを提供
- **ユーザビリティの向上**: しおり機能とヘッダフッタ機能の設定が直感的に操作可能
- **プロジェクト管理の強化**: しおり設定とヘッダフッタ設定も含めてプロジェクト単位で保存

### v1.4.0 (2024年12月17日)
#### ? 新機能
- **クリップボード機能の改善**: ファイル名のみをシンプルな改行区切り形式でクリップボードにコピーする機能を追加
  - 従来の詳細情報付きコピー機能に加えて、シンプルなファイル名リストの取得が可能
  - 外部アプリケーションとの連携が容易になりました
  - 選択されたファイルのみ、または全ファイルの選択オプションを維持

#### ?? 改善点
- **クリップボード処理の最適化**: ユーザーの使用頻度が高いシンプルなファイル名コピー機能を優先実装
- **ユーザーエクスペリエンスの向上**: より直感的で使いやすいクリップボード機能

### v1.3.0 (2024年12月14日)
#### ?? 新機能
- **ファイル更新時の自動選択機能**: ファイル更新ボタンを押した際に、PDF化されていないファイルに自動的にチェックが入るようになりました
  - 新規追加されたファイルで未変換のものは自動選択
  - 既存ファイルでPDFが存在しなくなった場合も自動選択
  - PDFファイル自体は対象外（変更なし）

#### ?? 改善点
- ファイル管理効率の向上：PDF変換が必要なファイルを見つけやすくなりました
- ユーザビリティの向上：手動でチェックを入れる手間を軽減

### v1.2.0 (2024年12月)
#### ?? ユーザーインターフェース改善
- **メインウィンドウサイズの拡大**: 1200×700 → 1400×800に変更し、より多くの情報を一度に表示可能
- **左側プロジェクトパネルの拡大**: 300px → 350pxに変更し、プロジェクト名の表示を改善
- **ファイル一覧の表示改善**: 
  - 表示名列: 200px → 250px
  - フォルダ列: 150px → 180px  
  - 更新日時列: 130px → 150px
  - PDFステータス列: 100px → 120px
- **一括リネームダイアログの拡大**: 800×500 → 1100×650に変更
- **ファイル名変更ダイアログの拡大**: 600px → 700px幅に変更

#### ?? 新機能
- **バージョン情報の表示**: 
  - ウィンドウタイトルにバージョン番号を表示
  - ステータスバー右側にバージョン情報を表示
  - アセンブリ情報から動的にバージョンを取得

### v1.1.0 (2024年11月)
#### ?? 新機能
- **ファイル名変更機能**: 個別および一括でファイル名を変更可能
- **プロジェクト管理機能**: フォルダ単位でのプロジェクト管理
- **カテゴリ管理**: プロジェクトをカテゴリ別に分類
- **ドラッグ&ドロップ対応**: フォルダの選択が簡単に

#### ?? ユーザーインターフェース
- 視覚的に分かりやすいプロジェクト管理UI
- カテゴリ別の色分け表示
- コンテキストメニューによる操作

### v1.0.0 (2024年10月)
#### ?? 初回リリース
- **基本PDF変換機能**: Word、Excel、PowerPoint文書のPDF変換
- **PDF結合機能**: 複数PDFファイルの結合
- **ページ指定機能**: 特定ページのみの変換
- **ファイル管理**: ファイル一覧表示と選択機能
- **進行状況表示**: 変換・結合の進行状況を表示

## プロジェクト構造
Nico2PDF/
├── Models/                    # データモデル
│   ├── ProjectData.cs        # プロジェクトデータ
│   ├── FileItemData.cs       # ファイルアイテムデータ
│   ├── FileItem.cs           # ファイルアイテム
│   └── BatchRenameItem.cs    # 一括リネームアイテム
├── Views/                     # ビュー
│   ├── MainWindow.xaml       # メインウィンドウ
│   ├── MainWindow.xaml.cs    # メインウィンドウコードビハインド
│   ├── ProjectEditDialog.xaml # プロジェクト編集ダイアログ
│   ├── ProjectEditDialog.xaml.cs # プロジェクト編集ダイアログコードビハインド
│   ├── FileRenameDialog.xaml # ファイル名変更ダイアログ
│   ├── FileRenameDialog.xaml.cs # ファイル名変更ダイアログコードビハインド
│   ├── BatchRenameDialog.xaml # 一括リネームダイアログ
│   └── BatchRenameDialog.xaml.cs # 一括リネームダイアログコードビハインド
├── Services/                  # サービス
│   ├── ProjectManager.cs     # プロジェクト管理
│   ├── PdfConversionService.cs # PDF変換サービス
│   ├── PdfMergeService.cs    # PDF結合サービス
│   └── FileManagementService.cs # ファイル管理サービス
├── ViewModels/               # ビューモデル（将来の拡張用）
├── Converters/               # 値コンバーター（将来の拡張用）
├── Controls/                 # カスタムコントロール（将来の拡張用）
├── App.xaml                  # アプリケーション定義
├── App.xaml.cs               # アプリケーションコードビハインド
└── AssemblyInfo.cs           # アセンブリ情報
## 技術スタック

- .NET 6.0
- WPF (Windows Presentation Foundation)
- Microsoft Office Interop
- iTextSharp

## 依存関係

- Microsoft.Office.Interop.Word
- Microsoft.Office.Interop.Excel
- Microsoft.Office.Interop.PowerPoint
- iTextSharp
- System.Text.Json

## 使用方法

### 基本的な使い方
1. プロジェクトを作成または選択
2. 対象フォルダを選択（ドラッグ&ドロップまたはボタンから）
3. ファイルを読み込み
4. 必要に応じてファイル順序を変更
5. PDF変換を実行
6. PDF結合を実行

### 新機能: ヘッダ・フッタ機能（v1.5.0）
- **チェックボックス設定**: PDF結合時にヘッダ・フッタ追加のON/OFFを設定可能
- **ヘッダ位置**: 左上に配置
- **フッタ位置**: 右下に配置
- **同一テキスト**: ヘッダとフッタには同じテキストを表示
- **フォントサイズ調整**: 10ptを基準に、任意のサイズに調整可能
- **カスタムテキスト**: 会社名、文書タイトル、日付など自由なテキストを設定可能
- **プロジェクト保存**: ヘッダフッタ設定もプロジェクト単位で保存

### 新機能: しおり機能（v1.5.0）
- **チェックボックス設定**: PDF結合時にしおり追加のON/OFFを設定可能
- **基本しおり**: ファイル名をしおりとして追加
- **階層しおり**: サブフォルダを含む場合、フォルダ別に階層構造でしおりを作成
- **表示名使用**: しおりタイトルには表示名（リネーム後の名前）を使用
- **グループ化オプション**: フォルダ別グループ化の有効/無効を選択可能

### 新機能: クリップボード機能（v1.4.0）
- **シンプルコピー**: ファイル名のみを改行区切りでクリップボードにコピー
- **選択オプション**: 選択されたファイルのみ、または全ファイルから選択可能
- **外部連携**: 他のアプリケーションとの連携が容易

### ファイル更新機能（v1.3.0）
- **自動選択**: ファイル更新ボタンを押すと、PDF化されていないファイルに自動的にチェックが入ります
- **効率的な作業**: 変換が必要なファイルを手動で探す必要がありません
- **スマート判定**: PDFファイル自体は対象外となり、Office文書のみが対象となります

### ファイル名変更機能
- **個別変更**: ファイルを選択して「名前変更」ボタンをクリック
- **一括変更**: 複数ファイルを選択して「一括変更」ボタンをクリック
- **表示名リセット**: 変更した表示名を元に戻す

### プロジェクト管理
- **新規作成**: 「新規プロジェクト」ボタンから作成
- **切り替え**: プロジェクト一覧からダブルクリックまたは「プロジェクト切り替え」
- **編集**: プロジェクトを選択して「プロジェクト編集」
- **カテゴリ**: プロジェクトをカテゴリ別に分類管理

## 設計原則

- **責任分離**: ModelとServiceに分離
- **保守性**: 各機能を独立したクラスに分離
- **拡張性**: 将来の機能追加を考慮した構造
- **可読性**: 適切なコメントと名前付け
- **ユーザビリティ**: 直感的で使いやすいインターフェース

## 今後の拡張可能性

- ViewModels: MVVMパターンの本格実装
- Converters: データバインディングの値変換
- Controls: 再利用可能なカスタムコントロール
- 設定管理: アプリケーション設定の管理
- ログ機能: エラーログや操作ログの記録
- 多言語対応: 国際化対応
- テーマ機能: ダークモード等のテーマ切り替え

## システム要件

- Windows 10/11
- .NET 6.0 Runtime
- Microsoft Office (Word, Excel, PowerPoint)

## ライセンス

このソフトウェアは内部使用目的で開発されました。

## サポート・問い合わせ

機能改善の提案やバグ報告は開発チームまでお知らせください。

詳細なリリースノートは [RELEASE_NOTES.md](RELEASE_NOTES.md) をご参照ください。